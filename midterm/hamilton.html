<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="card.css">

        <style>
        .center {
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        .back {
        transform: rotateY(-180deg);
        padding: 0 2em;
        font-size: large;
        text-align: left;
        }
        </style>
        
        <title>F1's Greatest Drivers</title>
    </head>
    <body>
        <a href="index.html">
            <img src="img/title.png" width="1000px" class="center">
        </a>

        <br>
        <br>

        <img src="img/hamilton.png" width="800px" class="center">

        <br>

        <div class="container text-center">
            <div class="row">
                <div class="col-5">
                    <div class="content">
                        <a class="card center" href="#!">
                        <div class="front" style="background-image: url(https://media.formula1.com/content/dam/fom-website/drivers/2023Drivers/hamilton.jpg.img.1920.medium.jpg/1677069594164.jpg)">
                        </div>

                        <div class="back">
                        <div>
                            <img src="https://media.formula1.com/content/dam/fom-website/manual/Helmets2023/hamilton.png" width="300px">
                            <br>
                            <p style="text-align: left; color: white;"><b>Country:</b> United Kingdom</p>
                            <p style="text-align: left; color: white;"><b>Race Number:</b> 44</p>
                            <p style="text-align: left; color: white;"><b>Years Active:</b> 2007 - present</p>
                        </div>
                        </div>
                        </a>
                    </div>
                </div>
                <div class="col">
                    <br>
                    <button id="request" class="btn btn-primary btn-lg center" style="background-color: #15151e; color: white;"> Click to learn more about Lewis Hamilton</button>
                    <div id="bio" style="text-align: left;"></div>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <br>
                    <br>
                    <h3>2023 Season Statistics</h3>
                    <div id="stats-table" class="table"></div>
                </div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

        <script>
            const bioBtn = document.getElementById('request');
            const statsBtn = document.getElementById('request');

            function fetchBio() {
                const apiUrl = 'https://en.wikipedia.org/w/api.php?action=query&origin=*&prop=extracts&exintro&titles=Lewis_Hamilton&format=json';

                // use the fetch API to make the request
                fetch(apiUrl)
                    .then(response=> response.json ())
                    .then(data => {
                        //extract the page content from the API response
                        const pages = data.query.pages;
                        const pageId = Object.keys(pages)[0];
                        const content = pages[pageId].extract;

                        // display the content on the page
                        const bio = document.getElementById('bio');
                        bio.innerHTML = content;
                    })
                    .catch(error => {
                        console.error('Error fetching Wikipedia data:', error);
                    });
            }

            function fetchStats () {
                const apiUrl = 'https://ergast.com/api/f1/2023/drivers/hamilton/results';

                //use the fetch API to make the request
                fetch(apiUrl)
                    .then(response => response.text())
                    .then(data => {
                        // Split the text data into an array of lines
                        const lines = data.split('\n');

                        // Create a table element
                        const table = document.createElement('table');
                        table.className = 'table'; // Add Bootstrap table class for styling

                        // Create a table header
                        const thead = table.createTHead();
                        const headerRow = thead.insertRow();
                        //const headers = ['Race', 'Round', 'Circuit', 'Date', 'Time', 'Position', 'Points'];

                        headers.forEach(headerText => {
                            const th = document.createElement('th');
                            th.innerText = headerText;
                            headerRow.appendChild(th);
                        });

                        // Create table rows with data
                        const tbody = table.createTBody();
                        lines.forEach(line => {
                            const columns = line.split(',');
                            if (columns.length === 7) { // Assuming each row has 7 columns
                                const row = tbody.insertRow();
                                columns.forEach(columnText => {
                                    const cell = row.insertCell();
                                    cell.innerText = columnText;
                                });
                            }
                        });

                        // Append the table to the 'stats-table' div
                        const statsTable = document.getElementById('stats-table');
                        statsTable.appendChild(table);
                    })
                    .catch(error => {
                        console.error('Error fetching ErgastF1 data:', error);
                    });
            }

            fetchStats();

            bioBtn.addEventListener('click', fetchBio);
            window.addEventListener('load', fetchStats);
        </script>
    </body>
</html>
